# Usage Guide

This guide provides detailed instructions for using the Kindle to Readwise Converter.

## Table of Contents
1. [Getting Your Kindle Export](#getting-your-kindle-export)
2. [Running the Converter](#running-the-converter)
3. [Understanding the Output](#understanding-the-output)
4. [Importing to Readwise](#importing-to-readwise)
5. [Troubleshooting](#troubleshooting)

## Getting Your Kindle Export

### Method 1: Kindle Desktop App (Recommended)

**Mac:**
1. Open Kindle app
2. Open the book you want to export
3. Press `Cmd + Shift + N` or go to **View ‚Üí Notebook**
4. Click the **Export** button in the top-right
5. Choose a location and save the HTML file

**Windows:**
1. Open Kindle app
2. Open the book
3. Press `Ctrl + Shift + N` or go to **Tools ‚Üí Notebook**
4. Click **Export**
5. Save the HTML file

### Method 2: Kindle Cloud Reader

1. Go to [read.amazon.com](https://read.amazon.com)
2. Open your book
3. Click the **Notebook** icon (top-right)
4. Click **Export** and download the HTML file

### Method 3: Kindle Device Export

If you use a Kindle e-reader:
1. Connect your Kindle to your computer via USB
2. Navigate to `Kindle/documents/My Clippings.txt`
3. You'll need to convert this format first (tool coming soon!)

## Running the Converter

### Option 1: Interactive Mode (Easiest for Beginners)

Simply run the script without any arguments:

```bash
python kindle_to_readwise.py
```

You'll see:
```
============================================================
Kindle to Readwise Converter
============================================================

Please provide the path to your Kindle HTML export file.
(Drag and drop the file here, or type the path)

HTML file path: 
```

**Tips:**
- You can drag and drop the HTML file into the terminal
- The script will automatically remove quotes if you drag and drop
- Press Enter after providing the path

The script will then ask:
```
Fetch book metadata from Google Books? (recommended)
This will clean up the book title and author name.
Fetch metadata? (y/n) [y]: 
```

- Press Enter or type `y` to fetch metadata (recommended)
- Type `n` if you want to skip metadata fetching

### Option 2: Command Line (Quick)

If you know the file path:

```bash
python kindle_to_readwise.py /path/to/your/book.html
```

This will:
- Process the file immediately
- Automatically fetch metadata from Google Books
- Create a CSV in the same directory as the HTML file

### Option 3: Python Module (Advanced)

Use the converter in your own Python scripts:

```python
from kindle_to_readwise import process_kindle_export

# Basic usage
output_file = process_kindle_export('my_book.html')

# Specify output location
output_file = process_kindle_export(
    html_file_path='kindle_exports/book.html',
    output_csv_path='readwise_imports/book_formatted.csv'
)

# Skip metadata fetching
output_file = process_kindle_export(
    html_file_path='my_book.html',
    fetch_metadata=False
)
```

## Understanding the Output

### What You'll See

When running the converter, you'll see output like:

```
üìö Reading Kindle export: atomic_habits.html
üîç Parsing highlights...
   Found: Atomic Habits
   Author: James Clear
   Sections: 15
   Total highlights: 47

üìä Converting to Readwise format...
üåê Fetching book metadata from Google Books...
   Updated title: Atomic Habits: An Easy & Proven Way to Build Good Habits & Break Bad Ones
   Updated author: James Clear

‚úÖ CSV exported successfully: atomic_habits_readwise.csv
   Total rows: 62

üéâ Ready to upload to Readwise!
   Visit: https://readwise.io/import

üìÅ Output file: atomic_habits_readwise.csv
```

### CSV Structure

The output CSV has these columns:

| Column | Description | Example |
|--------|-------------|---------|
| Highlight | The text or heading | "Chapter 1: Introduction" |
| Title | Book title | "Atomic Habits" |
| Author | Author name(s) | "James Clear" |
| Note | Tags or your notes | ".h1" or ".favorite" or "My thought here" |
| Location | Page/location number | 15 |
| Date | Export timestamp | "2025-01-15 10:30:00" |

### Special Tags

- `.h1` - Chapter headings (displays as bold headers in Readwise)
- `.favorite` - Pink highlights (starred in Readwise)
- Regular text - Your personal notes attached to highlights

## Importing to Readwise

### Step-by-Step

1. **Go to Readwise Import Page**
   - Visit: [https://readwise.io/import](https://readwise.io/import)
   - Or: Settings ‚Üí Import ‚Üí CSV

2. **Upload Your CSV**
   - Click "Choose File"
   - Select the `*_readwise.csv` file generated by the converter
   - Click "Import"

3. **Verify Import**
   - Readwise will show a preview
   - Check that headings appear as bold headers
   - Verify pink highlights are starred
   - Confirm notes are attached correctly

4. **Complete Import**
   - Click "Confirm Import"
   - Wait for processing to complete
   - Your highlights are now in Readwise!

### What to Check in Readwise

After importing:
- ‚úÖ Chapter headings should be bold and larger
- ‚úÖ Pink highlights should have a star/favorite icon
- ‚úÖ Your notes should appear under their highlights
- ‚úÖ Book cover and metadata should be correct
- ‚úÖ Highlights should be in the right order

## Troubleshooting

### File Not Found Error

```
‚ùå Error: HTML file not found: my_book.html
```

**Solution:**
- Check that the file path is correct
- Use absolute path: `/Users/you/Documents/book.html`
- Or run the script from the same directory as the HTML file

### Invalid HTML Format Error

```
‚ùå Error: Invalid Kindle HTML format. Could not find bodyContainer.
```

**Solution:**
- Verify this is a Kindle Notebook export (not a regular web page)
- Re-export from Kindle app
- Check that the file isn't corrupted

### Metadata Fetch Failed

```
‚ö†Ô∏è  Could not fetch metadata from Google Books: Connection timeout
   Using original title and author from Kindle export.
```

**Solution:**
- This is just a warning - your CSV will still work
- Check your internet connection
- Re-run with metadata fetching disabled: `fetch_metadata=False`
- Some books may not be in Google Books database

### Empty or Missing Highlights

If the CSV has fewer highlights than expected:
- Check the original HTML file in a browser
- Ensure highlights are visible in Kindle app before exporting
- Some highlights may be filtered out (check Kindle notebook settings)

### CSV Upload Fails in Readwise

If Readwise rejects your CSV:
- Verify the CSV opens correctly in Excel/Numbers
- Check for required columns: Highlight, Title, Author
- Ensure no corruption (re-generate the CSV)
- Try uploading a single chapter first to test

### Permission Denied Error

```
PermissionError: [Errno 13] Permission denied: 'output.csv'
```

**Solution:**
- Close the CSV file if it's open in Excel/Numbers
- Check you have write permissions in the directory
- Try saving to a different location

## Tips for Best Results

### Before Exporting from Kindle
1. Review your highlights in the Kindle notebook
2. Add notes to important highlights
3. Use pink highlights for your favorites
4. Organize highlights by chapter

### When Using the Converter
1. Always fetch metadata (unless offline)
2. Keep HTML files organized by book
3. Use descriptive filenames
4. Process one book at a time

### After Importing to Readwise
1. Review the import immediately
2. Add tags in Readwise if needed
3. Fix any formatting issues
4. Set up daily review reminders

## Advanced Usage

### Batch Processing (Coming Soon)

Currently, you need to run the converter once per book. Batch processing is planned:

```bash
# Future feature
python kindle_to_readwise.py --batch exports/*.html
```

### Custom Output Format

To modify the output format, edit the `convert_to_dataframe()` function:

```python
# Add custom columns
data.append({
    'Highlight': highlight_text,
    'Title': title,
    'Author': authors,
    'Note': note_text,
    'Location': page,
    'Date': date,
    'Custom_Field': 'your_value'  # Add your field
})
```

### Filtering Highlights

To only export certain types of highlights, modify the parsing logic:

```python
# Only export pink highlights
if highlight_type_val == 'Highlight (pink)':
    data.append({...})
```

## Getting Help

If you're still stuck:

1. **Check the README**: [README.md](README.md)
2. **Search Issues**: [GitHub Issues](https://github.com/sameerbajaj/kindle-to-readwise/issues)
3. **Open New Issue**: Provide details about your problem
4. **Contact**: Include your error message and steps taken

---

Happy reading and highlighting! üìö‚ú®
